---
layout: post
title: Docker GPU ì„¤ì •
subtitle: Docker GPU ì„¤ì •
author: useok
banner:
  image: assets/images/banners/home.jpeg
  opacity: 0.618
  background: "#000"
  height: "40vh"
  min_height: "10vh"
  heading_style: "font-size: 2.5rem; font-weight: bold;"
  subheading_style: "color: gold"
categories: [docker]
tags: [docker, GPU]
sidebar: [article-menu,category-list] 
---
## Docker GPU ì„¤ì •

```
ğŸ’¡ ê°œë°œí™˜ê²½
AWS EC2 / ubuntu 22.04 / 16GB / 500GB / g4dn.xlarge (nvidia t4, 16GB)

```

### [00.] ê¸°ì¡´ ì„¤ì¹˜ë˜ì–´ ìˆëŠ” Docker ì œê±°

```bash
sudo apt-get remove docker docker-engine docker.io containerd runc
sudo rm -rf /var/lib/docker
sudo apt-get autoclean
sudo apt-get update
```

### [01.] NVIDIA Driver ì„¤ì¹˜

#### [01.01.] ì„¤ì¹˜í•  ë“œë¼ì´ë²„ ë²„ì „ í™•ì¸

`sudo apt-get install ubuntu-drivers-common`

`ubuntu-drivers devices`

![Untitled](/assets/images/postImages/2023-10-20-121434-Docker GPU ì„¤ì •/Untitled.png)

#### [01.02.] ë“œë¼ì´ë²„ ì„¤ì¹˜

```bash
sudo apt -y install nvidia-driver-535

## ë˜ëŠ” ë°‘ì˜ ëª…ë ¹ì–´ë¡œ ì ì ˆí•œ ë²„ì „ì„ ìë™ ì„¤ì¹˜ ê°€ëŠ¥
# sudo ubuntu-drivers autoinstall
```

#### [01.03.] ì¬ë¶€íŒ…

`sudo reboot now`

#### [01.04.] ë“œë¼ì´ë²„ ì‘ë™ í™•ì¸

`nvidia-smi`

![Untitled](/assets/images/postImages/2023-10-20-121434-Docker GPU ì„¤ì •/Untitled 1.png)

### [02.] Docker ì„¤ì¹˜

#### [02.01.] íŒ¨í‚¤ì§€ ì„¤ì¹˜

```bash
sudo apt-get update

sudo apt-get install \
    ca-certificates \
    curl \
    gnupg \
    lsb-release
```

#### [02.02.] GPGí‚¤ & ì €ì¥ì†Œ ì¶”ê°€

`curl -fsSL https://download.docker.com/linux/ubuntu/gpg | sudo gpg --dearmor -o /usr/share/keyrings/docker-archive-keyring.gpg`

#### [02.03.] Docker ì—”ì§„ ì„¤ì¹˜

`sudo apt update`

`sudo apt install docker-ce docker-ce-cli containerd.io`

#### [02.04.] í˜„ì¬ ì‚¬ìš©ìì— Docker ê¶Œí•œ ë¶€ì—¬

`sudo usermod -aG docker ${USER}`

### [03.] nvidia-docker ì„¤ì¹˜

#### [03.01.] GPGí‚¤  & ì €ì¥ì†Œ ì¶”ê°€

```bash
distribution=$(. /etc/os-release;echo $ID$VERSION_ID) \
   && curl -s -L https://nvidia.github.io/nvidia-docker/gpgkey | sudo apt-key add - \
   && curl -s -L https://nvidia.github.io/nvidia-docker/$distribution/nvidia-docker.list | sudo tee /etc/apt/sources.list.d/nvidia-docker.list
```

#### [03.02.] nvidia-docker ì„¤ì¹˜

`sudo apt-get update`

`sudo apt-get install -y nvidia-docker2`

### [04.] Docker ì¬ì‹œì‘

`sudo systemctl restart docker`

### [05.] GPU ì‘ë™ í™•ì¸

`docker run --rm --gpus all ubuntu:18.04 nvidia-smi`

![Untitled](/assets/images/postImages/2023-10-20-121434-Docker GPU ì„¤ì •/Untitled 2.png)

`docker run -itd --ipc host --gpus all -p 8888:8888 -p 6006:6006 -v /:/workspace --restart always --name pytorch-gpu pytorch/pytorch`

![Untitled](/assets/images/postImages/2023-10-20-121434-Docker GPU ì„¤ì •/Untitled 3.png)